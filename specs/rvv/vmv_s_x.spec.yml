_: &default
  env: RVTEST_RV64UV
  head: |
    #include "exception.h"
    #include "test_macros_v.h"

  _templates: &_templates
    test_vmv_s_x: |
      test_{num}:
        li TESTNUM, {num};
        li a0, {vlen};
        li a1, {rs1};
        la a2, test_{num}_data;

        vsetvli t0, a0, e{ebits},m1,tu,mu;
        {name} v2, a1;
        {stins} v2, (a2);

        .pushsection .data, 1;
      test_{num}_data:
        .fill {vlen}, ({ebits}/8), 0;
        .popsection

  check:
    test_vmv_s_x: np.array_equal(result, golden)

vmv_s_x:
  templates:
    <<: *_templates
    test_vmv_s_x @ rs1, vlen @ ebits=8, ldins='lb', stins='vse8.v': |
      {inherit}
  
  <<: *default

  cases:
    test_vmv_s_x:
      - '[0, 1]'
      - '[1, 1]'
      - '[31, 1]'
      - '[32, 1]'
      - '[64, 1]'
      - '[65, 1]'
      - '[127, 1]'
      - '[128, 1]'
      - '[251, 1]'
      - '[252, 1]'
      - '[253, 1]'
      - '[254, 1]'
      - '[255, 1]'

vmv_s_x_16:
  templates:
    <<: *_templates
    test_vmv_s_x @ rs1, vlen @ ebits=16, ldins='lh', stins='vse16.v': |
      {inherit}
  
  <<: *default

  cases:
    test_vmv_s_x:
      - '[0x1000, 1]'
      - '[0x1008, 1]'
      - '[0x1020, 1]'
      - '[0x2030, 1]'
      - '[0x3f00, 1]'
      - '[0xf0ff, 1]'
      - '[0x6fff, 1]'
      - '[0x7000, 1]'

vmv_s_x_32:
  templates:
    <<: *_templates
    test_vmv_s_x @ rs1, vlen @ ebits=32, ldins='lw', stins='vse32.v': |
      {inherit}
  
  <<: *default

  cases:
    test_vmv_s_x:
      - '[0x10000000, 1]'
      - '[0x10000011, 1]'
      - '[0x10000103, 1]'
      - '[0x10001004, 1]'
      - '[0x1003ff05, 1]'