_: &default
  env: RVTEST_RV64UV
  head: |
    #include "exception.h"
    #include "test_macros_v.h"

  _templates: &_templates
    test_vmv_x_s: |
      test_{num}:
        li TESTNUM, {num};
        li a0, {vlen};
        la a1, {vs2_data}; 
        la a2, test_{num}_data;

        vsetvli t0, a0, e{ebits},m1,tu,mu;
        {ldins} v2, (a1);
        {name} a3, v2;
        {stins} a3, (a2);

        .pushsection .data, 1;
      test_{num}_data:
        .fill {vlen}, ({ebits}/8), 0;
        .popsection

  check:
    test_vmv_x_s: np.array_equal(result, golden)

vmv_x_s:
  templates:
    <<: *_templates
    test_vmv_x_s @ vs2, vlen @ ebits=8, ldins='vle8.v', stins='sb': |
      {inherit}

  <<: *default

  cases:
    test_vmv_x_s:
      - '[np.array([1],               dtype=np.int8), 1]'
      - '[np.array([1, 1, -1],        dtype=np.int8), 3]'
      - '[np.linspace(0, 0xff, 16,    dtype=np.int8), 16]'
      - '[np.linspace(-127, 128, 21,  dtype=np.int8), 21]'
      - '[np.linspace(-127, 128, 31,  dtype=np.int8), 31]'
      - '[np.linspace(-127, 128, 32,  dtype=np.int8), 32]'
      - '[np.linspace(-127, 128, 63,  dtype=np.int8), 63]'
      - '[np.linspace(-127, 128, 64,  dtype=np.int8), 64]'
      - '[np.linspace(-127, 128, 65,  dtype=np.int8), 65]'
      - '[np.linspace(-127, 128, 127, dtype=np.int8), 127]'
      - '[np.linspace(-127, 128, 128, dtype=np.int8), 128]'
      - '[np.linspace(-127, 128, 251, dtype=np.int8), 251]'
      - '[np.linspace(-127, 128, 512, dtype=np.int8), 512]'

vmv_x_s_16:
  templates:
    <<: *_templates
    test_vmv_x_s @ vs2, vlen @ ebits=16, ldins='vle16.v', stins='sh': |
      {inherit}

  <<: *default

  cases:
    test_vmv_x_s:
      - '[np.array([1],               dtype=np.int16), 1]'
      - '[np.array([1, 1, -1],        dtype=np.int16), 3]'
      - '[np.linspace(0x1000, 0xffff, 16,  dtype=np.int16), 16]'
      - '[np.linspace(0x1000, 0xffff, 21,  dtype=np.int16), 21]'
      - '[np.linspace(0x1000, 0xffff, 31,  dtype=np.int16), 31]'
      - '[np.linspace(0x1000, 0xffff, 32,  dtype=np.int16), 32]'
      - '[np.linspace(0x1000, 0xffff, 63,  dtype=np.int16), 63]'
      - '[np.linspace(0x1000, 0xffff, 64,  dtype=np.int16), 64]'
      - '[np.linspace(0x1000, 0xffff, 65,  dtype=np.int16), 65]'
      - '[np.linspace(0x1000, 0xffff, 127, dtype=np.int16), 127]'
      - '[np.linspace(0x1000, 0xffff, 128, dtype=np.int16), 128]'
      - '[np.linspace(0x1000, 0xffff, 251, dtype=np.int16), 251]'
      - '[np.linspace(0x1000, 0xffff, 256, dtype=np.int16), 256]'

vmv_x_s_32:
  templates:
    <<: *_templates
    test_vmv_x_s @ vs2, vlen @ ebits=32, ldins='vle32.v', stins='sw': |
      {inherit}

  <<: *default

  cases:
    test_vmv_x_s:
      - '[np.array([1],               dtype=np.int32), 1]'
      - '[np.array([1, 1, -1],        dtype=np.int32), 3]'
      - '[np.linspace(0x10000000, 0xffffffff, 16,  dtype=np.int32), 16]'
      - '[np.linspace(0x10000000, 0xffffffff, 21,  dtype=np.int32), 21]'
      - '[np.linspace(0x10000000, 0xffffffff, 31,  dtype=np.int32), 31]'
      - '[np.linspace(0x10000000, 0xffffffff, 32,  dtype=np.int32), 32]'
      - '[np.linspace(0x10000000, 0xffffffff, 63,  dtype=np.int32), 63]'
      - '[np.linspace(0x10000000, 0xffffffff, 64,  dtype=np.int32), 64]'
      - '[np.linspace(0x10000000, 0xffffffff, 65,  dtype=np.int32), 65]'
      - '[np.linspace(0x10000000, 0xffffffff, 127, dtype=np.int32), 127]'
      - '[np.linspace(0x10000000, 0xffffffff, 128, dtype=np.int32), 128]'

vmv_x_s_64:
  templates:
    <<: *_templates
    test_vmv_x_s @ vs2, vlen @ ebits=64, ldins='vle64.v', stins='sd': |
      {inherit}

  <<: *default

  cases:
    test_vmv_x_s:
      - '[np.array([1],               dtype=np.int64), 1]'
      - '[np.array([1, 1, -1],        dtype=np.int64), 3]'
      - '[np.linspace(0x1000000000000000, 0xffffffffffffffff, 16,  dtype=np.int64), 16]'
      - '[np.linspace(0x1000000000000000, 0xffffffffffffffff, 21,  dtype=np.int64), 21]'
      - '[np.linspace(0x1000000000000000, 0xffffffffffffffff, 31,  dtype=np.int64), 31]'
      - '[np.linspace(0x1000000000000000, 0xffffffffffffffff, 32,  dtype=np.int64), 32]'
      - '[np.linspace(0x1000000000000000, 0xffffffffffffffff, 63,  dtype=np.int64), 63]'
      - '[np.linspace(0x1000000000000000, 0xffffffffffffffff, 64,  dtype=np.int64), 64]'
