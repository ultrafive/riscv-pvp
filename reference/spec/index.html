
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.5">
    
    
      
        <title>Cases - RISC-V PVP</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.be71726b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/style.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#verification-case-specification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="RISC-V PVP" class="md-header__button md-logo" aria-label="RISC-V PVP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RISC-V PVP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cases
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ultrafive/riscv-pvp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ultrafive/riscv-pvp
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="RISC-V PVP" class="md-nav__button md-logo" aria-label="RISC-V PVP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    RISC-V PVP
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ultrafive/riscv-pvp/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ultrafive/riscv-pvp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../get-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../new-target/" class="md-nav__link">
        Support New Targets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../developing/" class="md-nav__link">
        Developing Guide
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        Command Line
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Cases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Cases
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#yaml-basics" class="md-nav__link">
    YAML basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#headers" class="md-nav__link">
    Headers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templates" class="md-nav__link">
    Templates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cases" class="md-nav__link">
    Cases
  </a>
  
    <nav class="md-nav" aria-label="Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameter-array" class="md-nav__link">
    Parameter Array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameter-matrix" class="md-nav__link">
    Parameter Matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-script" class="md-nav__link">
    Setup Script
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    Check
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      <label class="md-nav__link" for="__nav_5_3">
        Functions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Functions" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../functions/data/" class="md-nav__link">
        Test Data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../functions/utils/" class="md-nav__link">
        Utilities
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#yaml-basics" class="md-nav__link">
    YAML basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#headers" class="md-nav__link">
    Headers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templates" class="md-nav__link">
    Templates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cases" class="md-nav__link">
    Cases
  </a>
  
    <nav class="md-nav" aria-label="Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameter-array" class="md-nav__link">
    Parameter Array
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameter-matrix" class="md-nav__link">
    Parameter Matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-script" class="md-nav__link">
    Setup Script
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    Check
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ultrafive/riscv-pvp/edit/master/docs/reference/spec.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="verification-case-specification">Verification Case Specification</h1>
<p>This is a detailed reference guide to RISC-V PVP Verification Case Specification.</p>
<p>The best way to get started with YAML Verification Case Specification is to read
the customization guide. After that, to learn how to write your YAML cases
for your needs, see below topics.</p>
<h3 id="yaml-basics">YAML basics</h3>
<p>Verification Case Specification is written in YAML file format.
To learn the basics of YAML, please see <a href="https://learnxinyminutes.com/docs/yaml/">Learn YAML in Y Minutes</a>.</p>
<h2 id="structure">Structure</h2>
<p>A verification case <strong>Group</strong> is a group of one or more verification <strong>Cases</strong>. 
These <strong>Cases</strong> share same <strong>Environment</strong>, <strong>Headers</strong>, <strong>Templates</strong>,
case <strong>Params</strong> and <strong>Check</strong> rules.</p>
<p>This hierarchy is reflected in the structure of a YAML file like:</p>
<ul>
<li>Group 1<ul>
<li>Environment</li>
<li>Headers</li>
<li>Templates</li>
<li>Params</li>
<li>Check</li>
</ul>
</li>
<li>Group 2<ul>
<li>Environment</li>
<li>Headers</li>
<li>Templates</li>
<li>Params</li>
<li>Check</li>
</ul>
</li>
</ul>
<p>For example, We could define two simple case groups for rvv instructions, 
vadd.vi and vsub.vi.</p>
<div class="highlight"><pre><span></span><code><span class="nt">vadd_vi</span><span class="p">:</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">head</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">templates</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">cases</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">check</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">vsub_vi</span><span class="p">:</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">head</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">templates</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">cases</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">check</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Since vadd.vi and vsub.vi are both Vector Integer Arithmetic Instructions, and
could use same <strong>Environment</strong>, <strong>Headers</strong>, <strong>Templates</strong>, case <strong>Params</strong> and
<strong>Check</strong> rules. So we could use YAML's "anchors" feature to duplicate/inherit
properties from a same base group.</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">head</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">templates</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">cases</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">check</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">vadd_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>

<span class="nt">vsub_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>
</code></pre></div>
<p>The base group is named <code>_</code>, the <code>vadd_vi</code> and <code>vsub_vi</code> groups will inherit all
its properties, such as env, head, templates, cases, check. Group names start
with <code>_</code> will be ignored by parser, and not consider as a valid group.</p>
<p>So, the two syntax above are equivalent.</p>
<h2 id="environment">Environment</h2>
<p>We reuse riscv-test-env to define target environments, test virtual machine
(<a href="https://github.com/riscv/riscv-tests/#test-virtual-machines">TVM</a>) is used to define only used features for tests.</p>
<p>The following table shows the TVMs currently defined.</p>
<table>
<thead>
<tr>
<th>TVM Macro</th>
<th>TVM Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RVTEST_RV32U</code></td>
<td><code>rv32ui</code></td>
<td>RV32 user-level, integer only</td>
</tr>
<tr>
<td><code>RVTEST_RV32UF</code></td>
<td><code>rv32uf</code></td>
<td>RV32 user-level, integer and floating-point</td>
</tr>
<tr>
<td><code>RVTEST_RV32UV</code></td>
<td><code>rv32uv</code></td>
<td>RV32 user-level, integer, floating-point, and vector</td>
</tr>
<tr>
<td><code>RVTEST_RV32S</code></td>
<td><code>rv32si</code></td>
<td>RV32 supervisor-level, integer only</td>
</tr>
<tr>
<td><code>RVTEST_RV32M</code></td>
<td><code>rv32mi</code></td>
<td>RV32 machine-level, integer only</td>
</tr>
<tr>
<td><code>RVTEST_RV64U</code></td>
<td><code>rv64ui</code></td>
<td>RV64 user-level, integer only</td>
</tr>
<tr>
<td><code>RVTEST_RV64UF</code></td>
<td><code>rv64uf</code></td>
<td>RV64 user-level, integer and floating-point</td>
</tr>
<tr>
<td><code>RVTEST_RV64UV</code></td>
<td><code>rv64uv</code></td>
<td>RV64 user-level, integer, floating-point, and vector</td>
</tr>
<tr>
<td><code>RVTEST_RV64S</code></td>
<td><code>rv64si</code></td>
<td>RV64 supervisor-level, integer only</td>
</tr>
<tr>
<td><code>RVTEST_RV64M</code></td>
<td><code>rv64mi</code></td>
<td>RV64 machine-level, integer only</td>
</tr>
</tbody>
</table>
<p>For example, we use <code>RVTEST_RV64UV</code> for all rvv cases.</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RVTEST_RV64UV</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">vadd_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>

<span class="nt">vsub_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>
</code></pre></div>
<h2 id="headers">Headers</h2>
<p><strong>Headers</strong> section is used for test case templates to include header files.
The header files are placed in <code>macros</code> directory.</p>
<p>For example, all rvv cases will include "test_macros_v.h".</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RVTEST_RV64UV</span>
  <span class="nt">head</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">#include &quot;test_macros_v.h&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">vadd_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>

<span class="nt">vsub_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>
</code></pre></div>
<h2 id="templates">Templates</h2>
<p><strong>Templates</strong> section is used to place assembly code template for test cases.
The key is the test case name, value is the code template string for this test
case.</p>
<p>Variables in templates are delimited by braces <code>{}</code>. Except for internal
variables, other variables will be instantiated with the parameters defined in
the <strong>Cases</strong> section.</p>
<p>The following table shows the internal variables currently defined.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num</code></td>
<td>test case index number</td>
</tr>
<tr>
<td><code>name</code></td>
<td>instruction name converted from group name, <code>vadd_vi</code> will convert into <code>vadd.vi</code></td>
</tr>
<tr>
<td><code>*_shape</code></td>
<td>data will be generated by numpy's ndarray, this variable is the data shape.</td>
</tr>
<tr>
<td><code>*_data</code></td>
<td>data will be generated by numpy's ndarray, this variable is the data address.</td>
</tr>
</tbody>
</table>
<p>For example, the below template is a basic test case <code>test_basic_without_mask</code>
for <code>v*.vi</code>.
Except for internal variables, other variables such as <code>vs2_data</code>, <code>imm</code>, <code>vl</code>,
<code>sew</code>, <code>lmul</code> should be defined in <strong>Cases</strong> section.</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RVTEST_RV64UV</span>
  <span class="nt">head</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">#include &quot;test_macros_v.h&quot;</span>
  <span class="nt">templates</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">test_{num}:</span>
        <span class="no">li TESTNUM, {num};</span>

        <span class="no">// set vtype and vl</span>
        <span class="no">li a0, {vl}; </span>
        <span class="no">vsetvli t0, a0, e{sew},m{lmul},ta,ma;</span>

        <span class="no">// load input data into source vregs</span>
        <span class="no">la a2, {vs2_data}; </span>
        <span class="no">vle{sew}.v v16, (a2);</span>

        <span class="no">// run tested instruction</span>
        <span class="no">{name} v24, v16, {imm};</span>

        <span class="no">// store output data into result sections</span>
        <span class="no">la a4, test_{num}_data;</span>
        <span class="no">vse{sew}.v v24, (a4);</span>

        <span class="no">// push a result sub-section into signature in data section</span>
        <span class="no">.pushsection .data, 1;</span>
        <span class="no">.balign ({sew}/8)</span>
      <span class="no">test_{num}_data:</span>
        <span class="no">.fill ({vl}), ({sew}/8), 0;</span>
        <span class="no">.popsection</span>

    <span class="nt">test_basic_with_mask</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">vadd_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>

<span class="nt">vsub_vi</span><span class="p">:</span>
  <span class="nt">&lt;&lt;</span><span class="p">:</span> <span class="nv">*default</span>
</code></pre></div>
<h2 id="cases">Cases</h2>
<p><strong>Cases</strong> section defines test case parameters to instantiate the teamplate
variables.</p>
<p>There are three method to define parameters.</p>
<h3 id="parameter-array">Parameter Array</h3>
<p>The simplest method is define a parameter array. Continue with the above example,
we will define <code>vs2_data</code>, <code>imm</code>, <code>vl</code>, <code>sew</code>, <code>lmul</code> parameters for
<code>test_basic_without_mask</code> test case.</p>
<p>Each array item is a parameter array written in python.</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RVTEST_RV64UV</span>
  <span class="nt">head</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">#include &quot;test_macros_v.h&quot;</span>
  <span class="nt">templates</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>
  <span class="nt">cases</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">test_basic_without_mask @ vs2, imm, vl, sew @ lmul = 1</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;[np.array([4],</span><span class="nv"> </span><span class="s">dtype=np.int8),</span><span class="nv">             </span><span class="s">4,</span><span class="nv">  </span><span class="s">1,</span><span class="nv">  </span><span class="s">8]&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;[np.array([-2],</span><span class="nv"> </span><span class="s">dtype=np.int16),</span><span class="nv">           </span><span class="s">3,</span><span class="nv">  </span><span class="s">1,</span><span class="nv"> </span><span class="s">16]&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;[np.linspace(0,</span><span class="nv"> </span><span class="s">1,</span><span class="nv"> </span><span class="s">16,</span><span class="nv"> </span><span class="s">dtype=np.int32),</span><span class="nv">    </span><span class="s">9,</span><span class="nv"> </span><span class="s">16,</span><span class="nv"> </span><span class="s">32]&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;[np.linspace(0,</span><span class="nv"> </span><span class="s">-1,</span><span class="nv"> </span><span class="s">-31,</span><span class="nv"> </span><span class="s">dtype=np.int32),</span><span class="nv"> </span><span class="s">13,</span><span class="nv"> </span><span class="s">31,</span><span class="nv">  </span><span class="s">8]&#39;</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;[np.linspace(0,</span><span class="nv"> </span><span class="s">-15,</span><span class="nv"> </span><span class="s">16,</span><span class="nv"> </span><span class="s">dtype=np.int32),</span><span class="nv"> </span><span class="s">15,</span><span class="nv"> </span><span class="s">32,</span><span class="nv"> </span><span class="s">16]&#39;</span>
</code></pre></div>
<h3 id="parameter-matrix">Parameter Matrix</h3>
<p>We could define a parameter matrix to combine parameters. The parameter matrix
is a YAML object with a single <code>matrix</code> key in it. The keys of the matrix object
are variable names, and the values are also written in python.</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RVTEST_RV64UV</span>
  <span class="nt">head</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">#include &quot;test_macros_v.h&quot;</span>
  <span class="nt">templates</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>
  <span class="nt">cases</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span>
      <span class="nt">matrix</span><span class="p">:</span>
        <span class="nt">sew </span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">8</span><span class="p p-Indicator">,</span> <span class="nv">16</span><span class="p p-Indicator">,</span> <span class="nv">32</span><span class="p p-Indicator">,</span> <span class="nv">64</span><span class="p p-Indicator">]</span>
        <span class="nt">lmul</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">get_lmul_w(sew)</span>
        <span class="nt">vl  </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">get_vl(lmul, sew, vlen)</span>
        <span class="nt">vs1 </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">np.linspace(-100, 100).astype(get_intdtype(sew))</span>
        <span class="nt">imm </span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">-1</span><span class="p p-Indicator">,</span> <span class="nv">100</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h3 id="setup-script">Setup Script</h3>
<p>Pure python script to define parameters is also supported. A YAML object with a
single <code>setup</code> key in it is used to define setup script. Int the python script,
we should define and push all parameters into a <code>params_yml</code> array.</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RVTEST_RV64UV</span>
  <span class="nt">head</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">#include &quot;test_macros_v.h&quot;</span>
  <span class="nt">templates</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>
  <span class="nt">cases</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">test_basic_without_mask @ vs2, imm, vl, sew, lmul</span><span class="p p-Indicator">:</span>
      <span class="nt">setup</span><span class="p">:</span> <span class="p p-Indicator">|</span>
        <span class="no">params_yml = []</span>
        <span class="no">for sew in [8, 16, 32, 64]:</span>
          <span class="no">for lmul in get_lmul_w(sew):</span>
            <span class="no">for vl in get_vl(lmul, sew, vlen):</span>
              <span class="no">vs2 = np.linspace(-100, 100).astype(get_intdtype(sew))</span>
              <span class="no">imm = [1, -1, 100]</span>
              <span class="no">params_yml.append([vs2, imm, vl, sew, lmul])</span>
</code></pre></div>
<h2 id="check">Check</h2>
<p>Finally, we should define the check result rules in <code>check</code> section.
RISC-V PVP will compile the parameters injected templates into target elf file,
and run simulators to get result. Then, the result and golden will convert into
numpy ndarray's.</p>
<p>The check section is python code how to check <code>result</code> and <code>golden</code>, it will
return true if the check pass, otherwise false.</p>
<div class="highlight"><pre><span></span><code><span class="nt">_</span><span class="p">:</span> <span class="nl">&amp;default</span>
  <span class="nt">env</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RVTEST_RV64UV</span>
  <span class="nt">head</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">#include &quot;test_macros_v.h&quot;</span>
  <span class="nt">templates</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span> <span class="p p-Indicator">|</span>
      <span class="no">...</span>
  <span class="nt">cases</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">...</span>

  <span class="nt">check</span><span class="p">:</span>
    <span class="nt">test_basic_without_mask</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">np.array_equal(result, golden)</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../cli/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Command Line" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Command Line
            </div>
          </div>
        </a>
      
      
        
        <a href="../functions/data/" class="md-footer__link md-footer__link--next" aria-label="Next: Test Data" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Test Data
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 - 2021 UltraFive Team
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56a63758.min.js"></script>
      
    
  </body>
</html>